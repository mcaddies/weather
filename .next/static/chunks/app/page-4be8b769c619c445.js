(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4639:function(e,t,r){Promise.resolve().then(r.bind(r,5300))},5300:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return F}});var a=r(7437),n=r(2265),s=r(946),l=r(9827);function c(){return(0,a.jsxs)("header",{className:"mb-8 text-center",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold",children:"Weather Forecast App"}),(0,a.jsx)("p",{className:"text-lg",children:"5-Year Historical Weather Data"})]})}var i=r(3464);let o=i.Z.create({baseURL:"https://wft-geo-db.p.rapidapi.com/v1/geo",headers:{"X-RapidAPI-Key":"caf39c4f64msh7eb6eb11b696e4dp176209jsn6c41cca971dd","X-RapidAPI-Host":"wft-geo-db.p.rapidapi.com"}}),d=i.Z.create({baseURL:"https://weather.visualcrossing.com/VisualCrossingWebServices/rest/services/timeline"});async function u(e){if(!e)return[];try{return(await o.get("/cities",{params:{namePrefix:e,limit:10,sort:"-population"}})).data.data.map(e=>({id:e.id,name:e.city,country:e.country,latitude:e.latitude,longitude:e.longitude}))}catch(e){return console.error("Error searching cities:",e),[]}}async function h(e,t,r){try{var a;let n=r.toISOString().split("T")[0],s=(await d.get("/".concat(e,",").concat(t,"/").concat(n),{params:{key:"XV5LGQCCYQUK9HFMY9CK86AQU",unitGroup:"metric",include:"days",contentType:"json",elements:"datetime,temp,humidity,windspeed,conditions"}})).data.days[0],l=(a=s.conditions.split(",")[0].trim(),new Map([["clear","clear"],["sunny","clear"],["partly-cloudy-day","clouds"],["partly-cloudy-night","clouds"],["cloudy","clouds"],["rain","rain"],["snow","snow"],["thunder-rain","thunderstorm"],["thunder-showers-day","thunderstorm"],["thunder-showers-night","thunderstorm"],["showers-day","rain"],["showers-night","rain"]]).get(a.toLowerCase())||"unknown");return{temperature:s.temp,weather:l,humidity:s.humidity,windSpeed:s.windspeed,date:new Date(s.datetime).toISOString()}}catch(e){return console.error("Error fetching weather data:",e),null}}var m=r(2850);function x(e){let{onCitySelect:t}=e,[r,s]=(0,n.useState)(""),[l,c]=(0,n.useState)(!1),i=(0,n.useRef)(null),{data:o=[],isLoading:d}=(0,m.a)({queryKey:["cities",r],queryFn:()=>u(r),enabled:r.length>=2});(0,n.useEffect)(()=>{function e(e){i.current&&!i.current.contains(e.target)&&c(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let h=e=>{s("".concat(e.name,", ").concat(e.country)),t(e),c(!1)};return(0,a.jsxs)("div",{ref:i,className:"relative",children:[(0,a.jsx)("input",{type:"text",value:r,onChange:e=>{s(e.target.value),c(!0)},placeholder:"Search for a city",className:"p-2 border rounded w-full",onFocus:()=>c(!0)}),l&&r.length>=2&&(0,a.jsx)("ul",{className:"absolute z-10 w-full bg-white border rounded mt-1 max-h-60 overflow-auto",children:d?(0,a.jsx)("li",{className:"p-2",children:"Loading..."}):o.length>0?o.map(e=>(0,a.jsxs)("li",{onClick:()=>h(e),className:"p-2 hover:bg-gray-100 cursor-pointer",children:[e.name,", ",e.country]},e.id)):(0,a.jsx)("li",{className:"p-2",children:"No cities found"})})]})}var g=r(9520);function p(e){let{onDateRangeChange:t}=e,[r,s]=(0,n.useState)([null,null]),[l,c]=r;return(0,a.jsx)(g.ZP,{selectsRange:!0,startDate:l,endDate:c,onChange:e=>{s(e),t(e[0],e[1])},className:"p-2 border rounded",placeholderText:"Select date range"})}function f(e){let{onDateRangeChange:t,onCityChange:r}=e;return(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-8",children:[(0,a.jsx)(x,{onCitySelect:r}),(0,a.jsx)(p,{onDateRangeChange:t})]})}function y(e){let{dates:t}=e;return(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"p-2 border bg-gray-200 font-bold",children:"Year"}),t.map((e,t)=>(0,a.jsx)("th",{className:"p-2 border bg-gray-200 font-bold",children:e.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})},t))]})})}r(1005);var b=r(8164);function w(e){let{temperature:t,weather:r,isLoading:n=!1}=e;return n?(0,a.jsx)("td",{className:"p-2 border text-center",children:(0,a.jsx)("div",{className:"animate-pulse bg-gray-200 h-12 rounded"})}):t&&r?(0,a.jsxs)("td",{className:"p-2 border text-center",children:[(0,a.jsx)("div",{className:"text-2xl mb-1",children:(e=>{switch(e.toLowerCase()){case"clear":case"sunny":return"☀️";case"clouds":case"cloudy":return"☁️";case"rain":case"rainy":return"\uD83C\uDF27️";case"snow":case"snowy":return"\uD83C\uDF28️";case"thunderstorm":return"⛈️";case"drizzle":return"\uD83C\uDF26️";case"mist":case"fog":return"\uD83C\uDF2B️";default:return"❓"}})(r)}),(0,a.jsxs)("div",{className:"text-sm",children:[t.toFixed(1),"\xb0C"]})]}):(0,a.jsx)("td",{className:"p-2 border text-center",children:(0,a.jsxs)("div",{className:"text-gray-400",children:[(0,a.jsx)("div",{className:"text-2xl mb-1",children:"❓"}),(0,a.jsx)("div",{className:"text-sm",children:"N/A"})]})})}function j(e){let{year:t,dates:r,city:n}=e,s=(0,b.h)({queries:r.map(e=>{let r=new Date(e);return r.setFullYear(t),{queryKey:["weather",n.id,r.toISOString()],queryFn:()=>h(n.latitude,n.longitude,r),staleTime:1/0,cacheTime:36e5}})});return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"p-2 border bg-gray-100 font-bold",children:t}),s.map((e,t)=>{var r,n;let s=e.data;return(0,a.jsx)(w,{temperature:null!==(r=null==s?void 0:s.temperature)&&void 0!==r?r:null,weather:null!==(n=null==s?void 0:s.weather)&&void 0!==n?n:null,isLoading:e.isLoading},t)})]})}var v=r(2451),N=r(407);function D(e){let{onPrevious:t,onNext:r}=e;return(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4 p-2 bg-gray-100",children:[(0,a.jsx)("button",{onClick:t,className:"p-2 bg-white border rounded hover:bg-gray-100 transition-colors","aria-label":"Previous day",children:(0,a.jsx)(v.Z,{className:"w-6 h-6"})}),(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Weather Forecast"}),(0,a.jsx)("button",{onClick:r,className:"p-2 bg-white border rounded hover:bg-gray-100 transition-colors","aria-label":"Next day",children:(0,a.jsx)(N.Z,{className:"w-6 h-6"})})]})}function C(e){let{startDate:t,endDate:r,selectedCity:s}=e,[l,c]=(0,n.useState)([]),i=new Date().getFullYear(),o=Array.from({length:5},(e,t)=>i-t);return((0,n.useEffect)(()=>{if(t&&r){let e=[],a=new Date(t);for(;a<=r;)e.push(new Date(a)),a.setDate(a.getDate()+1);c(e)}},[t,r]),s)?0===l.length?(0,a.jsx)("div",{className:"text-xl",children:"Please select a date range"}):(0,a.jsxs)("div",{className:"w-full max-w-6xl bg-white rounded-lg shadow-lg overflow-hidden border border-gray-200",children:[(0,a.jsx)(D,{onPrevious:()=>{c(e=>e.map(e=>{let t=new Date(e);return t.setDate(t.getDate()-1),t}))},onNext:()=>{c(e=>e.map(e=>{let t=new Date(e);return t.setDate(t.getDate()+1),t}))}}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full border-collapse",children:[(0,a.jsx)(y,{dates:l}),(0,a.jsx)("tbody",{children:o.map(e=>(0,a.jsx)(j,{year:e,dates:l,city:s},e))})]})})]}):(0,a.jsx)("div",{className:"text-xl",children:"Please select a city"})}let S=new s.S({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}});function F(){let[e,t]=(0,n.useState)([null,null]),[r,s]=(0,n.useState)(null);return(0,a.jsx)(l.aH,{client:S,children:(0,a.jsxs)("main",{className:"flex min-h-screen flex-col items-center p-4 md:p-8",children:[(0,a.jsx)(c,{}),(0,a.jsx)(f,{onDateRangeChange:(e,r)=>{t([e,r])},onCityChange:e=>{s(e)}}),(0,a.jsx)(C,{startDate:e[0],endDate:e[1],selectedCity:r})]})})}}},function(e){e.O(0,[360,501,333,945,971,117,744],function(){return e(e.s=4639)}),_N_E=e.O()}]);